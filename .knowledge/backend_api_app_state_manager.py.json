{"is_source_file": true, "format": "Python", "description": "This file defines a thread-safe in-memory state management system for execution sessions, including classes for session state, progress, stats, and logs, as well as the StateManager class with methods to manipulate and retrieve session data.", "external_files": ["threading", "time", "uuid", "dataclasses", "typing"], "external_methods": ["threading.RLock", "time.time", "uuid.uuid4"], "published": ["create_session", "get", "append_log", "set_status", "set_artifacts", "set_progress", "mark_started", "mark_finished", "get_progress_view", "get_stats_view", "get_logs_view"], "classes": [{"name": "LogLine", "description": "Represents a single log message with timestamp, level, and message content."}, {"name": "Progress", "description": "Tracks the progress of a session with total and current steps, and computes percentage completed."}, {"name": "Stats", "description": "Holds statistical data about a session, such as duration, success flag, counts of passed, failed, skipped steps, and artifacts."}, {"name": "SessionState", "description": "Encapsulates the entire state of an execution session, including ID, status, timestamps, progress, stats, and logs."}, {"name": "StateManager", "description": "Main thread-safe class providing an interface to create, manipulate, and retrieve session states and related data."}], "methods": [{"name": "SessionState create_session(self)", "description": "Creates a new session with a unique ID and initial state.", "scope": "StateManager", "scopeKind": "class"}, {"name": "Optional[SessionState] get(self, session_id: str)", "description": "Retrieves session state by session ID.", "scope": "StateManager", "scopeKind": "class"}, {"name": "None append_log(self, session_id: str, level: str, message: str)", "description": "Adds a log entry to a session, maintaining a maximum number of log lines.", "scope": "StateManager", "scopeKind": "class"}, {"name": "None set_status(self, session_id: str, status: str)", "description": "Updates the status of a session.", "scope": "StateManager", "scopeKind": "class"}, {"name": "None set_artifacts(self, session_id: str, artifacts: Dict[str, str])", "description": "Sets or updates artifacts associated with a session.", "scope": "StateManager", "scopeKind": "class"}, {"name": "None set_progress(self, session_id: str, *, current_step: int, total_steps: int)", "description": "Sets the progress information for a session.", "scope": "StateManager", "scopeKind": "class"}, {"name": "None mark_started(self, session_id: str)", "description": "Marks a session as started, setting timestamps and status.", "scope": "StateManager", "scopeKind": "class"}, {"name": "None mark_finished(self, session_id: str, *, success: bool, totals: Dict[str, int], started_at: Optional[float])", "description": "Marks a session as finished, recording end time, success status, and statistics.", "scope": "StateManager", "scopeKind": "class"}, {"name": "Optional[Dict] get_progress_view(self, session_id: str)", "description": "Returns a summary of progress suitable for API responses.", "scope": "StateManager", "scopeKind": "class"}, {"name": "Optional[Dict] get_stats_view(self, session_id: str)", "description": "Returns session statistics data in a form suitable for output or API usage.", "scope": "StateManager", "scopeKind": "class"}, {"name": "Optional[List[Dict]] get_logs_view(self, session_id: str, *, level: Optional[str] = None, limit: Optional[int] = None)", "description": "Returns a list of log entries, filtered by level and limited in number.", "scope": "StateManager", "scopeKind": "class"}, {"name": "None __init__(self)", "scope": "StateManager", "scopeKind": "class", "description": "unavailable"}, {"name": "float percent(self)", "scope": "Progress", "scopeKind": "class", "description": "unavailable"}], "calls": ["uuid.uuid4", "time.time", "threading.RLock"], "search-terms": ["StateManager", "session", "progress", "logs", "artifacts", "thread safety", "execution session"], "state": 2, "file_id": 17, "knowledge_revision": 54, "git_revision": "", "revision_history": [{"41": ""}, {"54": ""}], "ctags": [{"_type": "tag", "name": "LogLine", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^class LogLine:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "MAX_LOG_LINES", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^MAX_LOG_LINES = 1000$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "Progress", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^class Progress:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SessionState", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^class SessionState:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "StateManager", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^class StateManager:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "Stats", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^class Stats:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def __init__(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "append_log", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def append_log(self, session_id: str, level: str, message: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, session_id: str, level: str, message: str)", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "artifacts", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    artifacts: Dict[str, str] = field(default_factory=dict)$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "Stats", "scopeKind": "class"}, {"_type": "tag", "name": "create_session", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def create_session(self) -> SessionState:$/", "language": "Python", "typeref": "typename:SessionState", "kind": "member", "signature": "(self)", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    created_at: float = field(default_factory=lambda: time.time())$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "SessionState", "scopeKind": "class"}, {"_type": "tag", "name": "current_step", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    current_step: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "Progress", "scopeKind": "class"}, {"_type": "tag", "name": "duration_seconds", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    duration_seconds: float = 0.0$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "Stats", "scopeKind": "class"}, {"_type": "tag", "name": "failed", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    failed: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "Stats", "scopeKind": "class"}, {"_type": "tag", "name": "finished_at", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    finished_at: Optional[float] = None$/", "language": "Python", "typeref": "typename:Optional[float]", "kind": "variable", "scope": "SessionState", "scopeKind": "class"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def get(self, session_id: str) -> Optional[SessionState]:$/", "language": "Python", "typeref": "typename:Optional[SessionState]", "kind": "member", "signature": "(self, session_id: str)", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "get_logs_view", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def get_logs_view(self, session_id: str, *, level: Optional[str] = None, limit: Optional[int/", "language": "Python", "typeref": "typename:Optional[List[Dict]]", "kind": "member", "signature": "(self, session_id: str, *, level: Optional[str] = None, limit: Optional[int] = None)", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "get_progress_view", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def get_progress_view(self, session_id: str) -> Optional[Dict]:$/", "language": "Python", "typeref": "typename:Optional[Dict]", "kind": "member", "signature": "(self, session_id: str)", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "get_stats_view", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def get_stats_view(self, session_id: str) -> Optional[Dict]:$/", "language": "Python", "typeref": "typename:Optional[Dict]", "kind": "member", "signature": "(self, session_id: str)", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "logs", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    logs: List[LogLine] = field(default_factory=list)$/", "language": "Python", "typeref": "typename:List[LogLine]", "kind": "variable", "scope": "SessionState", "scopeKind": "class"}, {"_type": "tag", "name": "mark_finished", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def mark_finished(self, session_id: str, *, success: bool, totals: Dict[str, int], started_a/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, session_id: str, *, success: bool, totals: Dict[str, int], started_at: Optional[float])", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "mark_started", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def mark_started(self, session_id: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, session_id: str)", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "passed", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    passed: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "Stats", "scopeKind": "class"}, {"_type": "tag", "name": "percent", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def percent(self) -> float:$/", "language": "Python", "typeref": "typename:float", "kind": "member", "signature": "(self)", "scope": "Progress", "scopeKind": "class"}, {"_type": "tag", "name": "progress", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    progress: Progress = field(default_factory=Progress)$/", "language": "Python", "typeref": "typename:Progress", "kind": "variable", "scope": "SessionState", "scopeKind": "class"}, {"_type": "tag", "name": "set_artifacts", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def set_artifacts(self, session_id: str, artifacts: Dict[str, str]) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, session_id: str, artifacts: Dict[str, str])", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "set_progress", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def set_progress(self, session_id: str, *, current_step: int, total_steps: int) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, session_id: str, *, current_step: int, total_steps: int)", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "set_status", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    def set_status(self, session_id: str, status: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, session_id: str, status: str)", "scope": "StateManager", "scopeKind": "class"}, {"_type": "tag", "name": "skipped", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    skipped: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "Stats", "scopeKind": "class"}, {"_type": "tag", "name": "started_at", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    started_at: Optional[float] = None$/", "language": "Python", "typeref": "typename:Optional[float]", "kind": "variable", "scope": "SessionState", "scopeKind": "class"}, {"_type": "tag", "name": "stats", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    stats: Stats = field(default_factory=Stats)$/", "language": "Python", "typeref": "typename:Stats", "kind": "variable", "scope": "SessionState", "scopeKind": "class"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    status: str = \"PENDING\"$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "SessionState", "scopeKind": "class"}, {"_type": "tag", "name": "success", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    success: bool = False$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "Stats", "scopeKind": "class"}, {"_type": "tag", "name": "total_steps", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    total_steps: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "Progress", "scopeKind": "class"}, {"_type": "tag", "name": "updated_at", "path": "/home/kavia/workspace/code-generation/execution-session-management-api-691-700/backend_api/app/state_manager.py", "pattern": "/^    updated_at: float = field(default_factory=lambda: time.time())$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "SessionState", "scopeKind": "class"}], "hash": "2d63464116c7b48d9d719ca614ec5395", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/app/state_manager.py", "fields": [{"name": "MAX_LOG_LINES = 1000", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str, str] artifacts", "scope": "Stats", "scopeKind": "class", "description": "unavailable"}, {"name": "float created_at", "scope": "SessionState", "scopeKind": "class", "description": "unavailable"}, {"name": "int current_step", "scope": "Progress", "scopeKind": "class", "description": "unavailable"}, {"name": "float duration_seconds", "scope": "Stats", "scopeKind": "class", "description": "unavailable"}, {"name": "int failed", "scope": "Stats", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[float] finished_at", "scope": "SessionState", "scopeKind": "class", "description": "unavailable"}, {"name": "List[LogLine] logs", "scope": "SessionState", "scopeKind": "class", "description": "unavailable"}, {"name": "int passed", "scope": "Stats", "scopeKind": "class", "description": "unavailable"}, {"name": "Progress progress", "scope": "SessionState", "scopeKind": "class", "description": "unavailable"}, {"name": "int skipped", "scope": "Stats", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[float] started_at", "scope": "SessionState", "scopeKind": "class", "description": "unavailable"}, {"name": "Stats stats", "scope": "SessionState", "scopeKind": "class", "description": "unavailable"}, {"name": "str status", "scope": "SessionState", "scopeKind": "class", "description": "unavailable"}, {"name": "bool success", "scope": "Stats", "scopeKind": "class", "description": "unavailable"}, {"name": "int total_steps", "scope": "Progress", "scopeKind": "class", "description": "unavailable"}, {"name": "float updated_at", "scope": "SessionState", "scopeKind": "class", "description": "unavailable"}]}